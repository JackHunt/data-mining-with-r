---
title: "Chapter 2 - Predicting Algae Blooms"
title-block-banner: true
number-sections: true
format:
  html:
    toc: true
    toc-location: left
    smooth-scroll: true
    df-print: kable
    tbl-print: kable
theme:
  dark: superhero
  light: flatly
---

# Setup
```{r}
library(DMwR)
library(knitr)
library(ggplot2)
library(ggthemes)
library(patchwork)
```

# Data Description
## Overview
The data contain the following variables

* Season in which the measurements were collected.
* River size.
* River speed.
* Max pH value.
* Min oxygen level.
* Mean over three measurements
  * Chloride.
  * Nitrates.
  * Ammonium.
  * Orthophosphate.
  * Phosphate.
  * Chlorophyll.

Associated with each are seven frequencies of harmful algae, per water sample.

## Summary
### Head
```{r}
head(algae)
```

### Summary Stats
```{r}
kable(summary(algae))
```

## Variable Distributions
```{r}
plot_variable <- function(var) {
    hist <- ggplot(algae, aes(x = {{ var }})) +
        geom_density() +
        theme_economist()

    qq <- ggplot(algae, aes(sample = {{ var }})) +
        stat_qq() +
        stat_qq_line() +
        theme_economist()

    hist + qq + plot_annotation(
        title = paste0("Distribution for ", deparse(substitute(var)))
    )
}
```

### Max pH
```{r}
#| warning: false
plot_variable(mxPH)
```

### Min Oxygen
```{r}
#| warning: false
plot_variable(mnO2)
```

### Mean Chloride
```{r}
#| warning: false
plot_variable(Cl)
```

### Mean Nitrates
```{r}
#| warning: false
plot_variable(NO3)
```

### Mean Ammonium
```{r}
#| warning: false
plot_variable(NH4)
```

### Mean Orthophosphate
```{r}
#| warning: false
plot_variable(oPO4)
```

### Mean Phosphate
```{r}
#| warning: false
plot_variable(PO4)
```

### Mean Chlorophyll
```{r}
#| warning: false
plot_variable(Chla)
```